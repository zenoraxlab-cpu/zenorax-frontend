<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="style.css">
    <title>Zenorax Sound Lab</title>
</head>

<body>

<!-- MODAL -->
<div id="toolModal" class="modal">
    <div class="modal-content">

        <h3 id="modalTitle">Tool</h3>

        <input id="modalFile" type="file" accept="audio/*,video/*" />

        <div id="modalParams"></div>

        <button class="btn btn-accent" onclick="runProcessing()">Process</button>
        <button class="btn btn-outline" onclick="closeModal()">Close</button>

        <div id="modalResult"></div>

    </div>
</div>

<!-- HEADER -->
<header>
    <div class="container">
        <div class="row">

            <div class="logo">
                <img src="assets/logo.png" alt="Zenorax Sound Lab">
            </div>

            <nav>
                <a href="#">Tools</a>
                <a href="#">Pricing</a>
                <a href="#">FAQ</a>
                <a href="#">Contact</a>
                <a href="#" class="btn">Sign In</a>
                <a href="#" class="btn btn-accent">Get Started</a>
            </nav>

        </div>
    </div>
</header>

<!-- HERO -->
<section class="hero container">

    <div class="hero-left">
        <h1 class="hero-title">Zenorax<br>Sound Lab</h1>
        <p class="hero-sub">
            Where sound is refined to its essence<br>
            with cutting-edge audio technology.
        </p>

        <div class="hero-buttons">
            <button class="btn btn-accent">Start Free</button>
            <button class="btn btn-outline">Explore Tools</button>
        </div>
    </div>

    <div class="hero-wave">
        <img src="assets/hero-wave.png" alt="sound-wave">
    </div>

</section>

<!-- TOOLS -->
<section class="section container">
    <h2>Core Tools</h2>
    <p class="sub">Fast, intuitive, professional</p>

    <div class="tools-grid">

        <div class="tool-card" onclick="openModal('Normalization')">
            <h3>Normalization</h3>
            <p>Automatic gain and LUFS adjustment.</p>
        </div>

        <div class="tool-card" onclick="openModal('Noise Reduction')">
            <h3>Noise Reduction</h3>
            <p>Remove background noise and hum.</p>
        </div>

        <div class="tool-card" onclick="openModal('Format Converter')">
            <h3>Format Converter</h3>
            <p>Convert WAV, FLAC, MP3, AAC.</p>
        </div>

        <div class="tool-card" onclick="openModal('Phone → Good Sound')">
            <h3>Phone → Good Sound</h3>
            <p>Improve smartphone recordings instantly.</p>
        </div>

        <div class="tool-card" onclick="openModal('Trim Silence')">
            <h3>Trim Silence</h3>
            <p>Auto-remove silence from start/end.</p>
        </div>

        <div class="tool-card" onclick="openModal('Basic Mastering')">
            <h3>Basic Mastering</h3>
            <p>Smooth compression and loudness.</p>
        </div>

    </div>
</section>

<!-- USP BLOCK -->
<section class="section container">

    <div class="usp">

        <div class="usp-text">
            <h2>Make your phone videos sound professional.</h2>
            <p>Perfect for saxophone lessons, music practice, vocals and mobile content.</p>

            <ul>
                <li>Noise Reduction</li>
                <li>EQ Correction</li>
                <li>Compression</li>
                <li>Normalization</li>
                <li>Video remuxing</li>
            </ul>

            <button class="btn btn-accent">Try Now</button>
        </div>

        <div class="usp-img"></div>

    </div>

</section>

<!-- PRICING -->
<section class="pricing">
    <div class="container">

        <h2>Pricing</h2>
        <p class="sub">Simple, transparent plans</p>

        <div class="pricing-cards">

            <div class="pricing-card">
                <h3>Free</h3>
                <p>Basic tools, limited processing.</p>
            </div>

            <div class="pricing-card">
                <h3>Normal</h3>
                <p>Full toolkit, higher limits.</p>
            </div>

            <div class="pricing-card">
                <h3>Pro</h3>
                <p>Unlimited tools & priority queue.</p>
            </div>

        </div>
    </div>
</section>

<!-- FOOTER -->
<footer>
    © 2025 Zenorax Sound Lab — All rights reserved.
</footer>

<!-- JS -->
<script>
const API = "https://zenorax-backend.onrender.com";

let currentTool = null;

function openModal(toolName) {
    currentTool = toolName;
    document.getElementById("modalTitle").innerText = toolName;

    const params = document.getElementById("modalParams");
    params.innerHTML = "";

    if (toolName === "Normalization") {
        params.innerHTML = `
            <label>Mode</label>
            <select id="normMode">
                <option value="lufs">LUFS (-14)</option>
                <option value="peak">Peak (-6)</option>
            </select>
        `;
    }

    if (toolName === "Format Converter") {
        params.innerHTML = `
            <label>Format</label>
            <select id="convFormat">
                <option value="wav">WAV</option>
                <option value="mp3">MP3</option>
                <option value="flac">FLAC</option>
                <option value="aac">AAC</option>
            </select>

            <label>Bitrate</label>
            <input id="convBitrate" type="number" placeholder="128 / 192 / 256">
        `;
    }

    if (toolName === "Trim Silence") {
        params.innerHTML = `
            <label>Preset</label>
            <select id="trimPreset">
                <option value="voice">Voice</option>
                <option value="music">Music</option>
                <option value="aggressive">Aggressive</option>
            </select>
        `;
    }

    if (toolName === "Phone → Good Sound") {
        params.innerHTML = `<p>Uses EQ + HPF + light compression</p>`;
    }

    if (toolName === "Noise Reduction" || toolName === "Basic Mastering") {
        params.innerHTML = `<p>Coming soon</p>`;
    }

    document.getElementById("toolModal").classList.add("show");
}

function closeModal() {
    document.getElementById("toolModal").classList.remove("show");
    document.getElementById("modalResult").innerHTML = "";
}

document.getElementById("toolModal").addEventListener("click", (e) => {
    if (e.target.id === "toolModal") {
        closeModal();
    }
});

async function runProcessing() {
    const fileInput = document.getElementById("modalFile");
    if (!fileInput.files.length) {
        alert("Select a file");
        return;
    }

    const formData = new FormData();
    formData.append("file", fileInput.files[0]);

    let endpoint = "";

    if (currentTool === "Normalization") {
        endpoint = "/normalize";
        const mode = document.getElementById("normMode").value;
        formData.append("mode", mode);
        formData.append("target", mode === "lufs" ? "-14" : "-6");
    }

    if (currentTool === "Trim Silence") {
        endpoint = "/trim";
        const preset = document.getElementById("trimPreset").value;
        formData.append("preset", preset);
    }

    if (currentTool === "Format Converter") {
        endpoint = "/convert";
        formData.append("format", document.getElementById("convFormat").value);
        formData.append("bitrate", document.getElementById("convBitrate").value);
    }

    if (currentTool === "Phone → Good Sound") {
        endpoint = "/normalize";
        formData.append("mode", "lufs");
        formData.append("target", "-14");
    }

    if (!endpoint) {
        alert("This tool is not implemented yet");
        return;
    }

    const resultBox = document.getElementById("modalResult");
    resultBox.innerHTML = "Processing...";

    const res = await fetch(API + endpoint, { method: "POST", body: formData });

    if (!res.ok) {
        resultBox.innerHTML = "Error processing file.";
        return;
    }

    const blob = await res.blob();
    const url = URL.createObjectURL(blob);

    const a = document.createElement("a");
    a.href = url;
    a.download = "processed.wav";
    a.click();

    resultBox.innerHTML = "Done ✔ File downloaded.";
}
</script>

</body>
</html>
